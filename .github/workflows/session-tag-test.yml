name: session tagging
on:
    workflow_dispatch:

jobs:
    do-the-thing:
        name: test session tags
        runs-on: ubuntu-latest
        steps:
          - name: assume role
            id: static-1
            uses: aws-actions/configure-aws-credentials@f1841dbacd36506c6e37ee12e6102abd7f162699
            with:
                role-to-assume: arn:aws:iam::884348119369:role/static-role-1
                aws-access-key-id: ${{ secrets.STATIC_1_AK_ID }}
                aws-secret-access-key: ${{ secrets.STATIC_1_SECRET_AK }}
                role-session-name: session-1-hiii
                aws-region: us-west-2
                retry-max-attempts: 6
                transitive-tag-keys: |
                    Repository
                    Workflow
                    Action
                    Actor

          - name: role chain!
            uses: aws-actions/configure-aws-credentials@f1841dbacd36506c6e37ee12e6102abd7f162699
            with:
                role-to-assume: arn:aws:iam::884348119369:role/spoke-session-tag
                role-session-name: session-2-hello
                aws-region: us-west-2
                retry-max-attempts: 6
                role-chaining: true

          - name: see whos logged in
            run: aws sts get-caller-identity